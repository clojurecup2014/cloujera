!function(wndw){var src=/.*\/204\.(min\.)?js(\?.*)?$/,_204v="0.02",maxGetSize=4e3,parse=function(data){var qs=[];for(var key in data)if("string"!=typeof data[key]&&wndw.JSON)qs.push(key+"="+encodeURIComponent(wndw.JSON.stringify(data[key])));else qs.push(key+"="+encodeURIComponent(data[key].toString()));if(!wndw.JSON)qs.push("_noJSON_=true");return qs.join("&")},post=function(beacon,data,callback){var iframe=document.createElement("iframe"),uniqueString=(new Date).getTime().toString();document.body.appendChild(iframe),iframe.style.display="none",iframe.name=uniqueString,iframe.contentWindow.name=uniqueString;var div=document.createElement("div");div.style.display="none";var form=document.createElement("form");form.target=uniqueString,form.action=beacon,form.method="POST",div.appendChild(form);var input;for(var key in data){if(input=document.createElement("input"),input.type="hidden",input.name=key,"string"!=typeof data[key]&&wndw.JSON)input.value=wndw.JSON.stringify(data[key]);else input.value=data[key].toString();form.appendChild(input)}document.body.appendChild(div),iframe.onload=iframe.onreadystatechange=function(){if(!this.readyState||"complete"==this.readyState)if(iframe.onreadystatechange=iframe.onload=null,iframe.parentNode.removeChild(iframe),form.parentNode.removeChild(form),callback&&"function"==typeof callback)callback()},form.submit()},get=function(beacon,data,dataStr,callback){var script=document.createElement("script");script.type="text/javascript",script.async=!0,script.src=beacon+"?"+dataStr,script.onload=script.onreadystatechange=function(){if(!this.readyState||"complete"==this.readyState)if(script.onreadystatechange=script.onload=null,script.parentNode.removeChild(script),callback&&"function"==typeof callback)callback()},script.onerror=function(){post(beacon,data,callback)},document.getElementsByTagName("head")[0].appendChild(script)},ping=function(beacon,data,callback){var dataStr=parse(data);if(dataStr.length<maxGetSize)get(beacon,data,dataStr,callback);else post(beacon,data,callback)},indentity=function(_){return _},cookie={set:function(key,value,options){if(options=options||{},null===value||void 0===value)options.days=-1;if("number"==typeof options.days){var days=options.days,t=new Date;t.setDate(t.getDate()+days),options.expires=t}if(!options.path)options.path="/";var encode=options.raw?indentity:encodeURIComponent,cookie=encode(key)+"="+encode(String(value));if(cookie+="; path="+options.path,options.expires)cookie+="; expires="+options.expires.toUTCString();if(options.domain)cookie+="; domain="+options.domain;if(options.secure)cookie+="; secure";return document.cookie=cookie,cookie},setOnce:function(key,value,options){var currentValue=cookie.get(key,options);if(null===currentValue)cookie.set(key,value,options),currentValue=value;return currentValue},get:function(key,options){options=options||{};for(var decode=options.raw?indentity:decodeURIComponent,pairs=document.cookie.split("; "),i=0,pair;pairs[i];i++)if(pair=pairs[i].split("="),decode(pair[0])===key)return decode(pair[1]||"");return null},remove:function(key,options){options=options||{},options.days=-1,cookie.set(key,null,options)}},generateSessionID=function(){return(1e10*Math.random()).toFixed()+"-"+(new Date).getTime()},removeCookies=function(keys,options){for(var i=keys.length-1;i>=0;i--)cookie.remove(keys[i],options)},initialize=function(twoohfour){twoohfour.options.session=twoohfour.session();var key=twoohfour.options.initialReferrerTracker,options={domain:twoohfour.options.domain,days:365};twoohfour.options.initialReferrer=cookie.setOnce(key,twoohfour.options.from,options)},TwoOhFour=function(){for(var scripts=wndw.document.scripts||document.getElementsByTagName("script"),count=scripts.length,referrer=wndw.document.referrer,parts=wndw.location.host.split(".");parts.length>2;)parts.shift();this.options={user:null,version:null,session:null,client:"204",from:referrer,domain:"."+parts.join("."),currentURL:wndw.location.href,tracker:"__204u",initialReferrerTracker:"__204r",beacon:"https://eventing.coursera.org/info"};for(var i=0;count>i;i++)if(src.test(scripts[i].src)){var match=/^.+\?(.*)$/.exec(scripts[i].src);if(match)for(var params=match[1].split("&"),j=0;j<params.length;j++){var param=params[j].split("=");if(/client|user|version|tracker|beacon/.test(param[0]))this.options[param[0]]=decodeURIComponent(param[1])}break}initialize(this)};TwoOhFour.prototype.session=function(id){var options={domain:this.options.domain,days:365},session=cookie.get(this.options.tracker,options);if(!session||id)session=id?id:generateSessionID(),cookie.set(this.options.tracker,session,options);return session},TwoOhFour.prototype.push=function(command){if("object"==typeof command)if(Array.isArray&&Array.isArray(command)||command.constructor==Array)switch(command[0]){case"send":this.send(command[1],command[2]);break;case"tracker":this.options.tracker=command[1],this.options.session=this.session();break;case"session":this.session=this.session(command[1]);break;case"post":this.send(command[1],command[2],!0);break;case"domain":var newDomain=command[1];if(newDomain!=this.options.domain)removeCookies([this.options.tracker,this.options.initialReferrerTracker],{domain:this.options.domain}),this.options.domain=newDomain,initialize(this);break;default:this.options[command[0]]=command[1]}else this.send(command);return this},TwoOhFour.prototype.send=function(data,callback,isPost){if("string"==typeof data)data={key:data};else data=data||{};if(wndw.location.href!=this.options.currentURL)this.options.from=this.options.currentURL,this.options.currentURL=wndw.location.href;if(this.options.user)data.user=this.options.user;if(this.options.version)data.version=this.options.version;if(this.options.from)data.from=this.options.from;if(this.options.initialReferrer)data.initialReferrer=this.options.initialReferrer;if(data.session=this.options.session,data.client=this.options.client,data.url=wndw.location.href,data.time=(new Date).getTime(),wndw.screen)data.screen={height:wndw.screen.height,width:wndw.screen.width};if(isPost)post(this.options.beacon,data,callback);else ping(this.options.beacon,data,callback);return this},TwoOhFour.prototype.batch=function(batch){for(;batch.length;)this.push(batch.shift());return this};var twoohfour=new TwoOhFour;if(wndw._204)if("object"==typeof wndw._204&&wndw._204.constructor==Array)twoohfour.batch(wndw._204);if(wndw._204=twoohfour,"function"==typeof define&&define.amd)define([],function(){return twoohfour})}(window);